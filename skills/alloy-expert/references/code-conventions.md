# PurgeTSS & Code Conventions

## ES6+ Features
Use `const`, `let`, destructuring, and template literals. Prefer arrow functions for callbacks and traditional functions for main logic.

```javascript
const loadUserData = (userId) => {
  const user = fetchUser(userId)
  return { ...user, loadedAt: Date.now() }
}
```

## No Semicolons
Omit semicolons at the end of lines (ASI handles it).

```javascript
const users = fetchUsers()
const name = user.name
```

## Styling with PurgeTSS (Utility-First)
Use utility classes for layout, colors, typography, and spacing. Avoid manual TSS files.

```xml
<!-- GOOD: PurgeTSS Utility Classes -->
<View class="vertical w-screen h-auto bg-gray-100">
  <Label class="text-xl font-bold text-blue-600 m-4" text="L('welcome')" />
</View>
```

**Critical PurgeTSS Rules:**
- NO `flex-row`/`flex-col` → Use `horizontal`/`vertical`
- NO `w-full` → Use `w-screen`
- NO `p-*` on Views → Use `m-*` on children
- NO `justify-*`/`items-center` → Use margins/positioning

## Platform & Device Modifiers
Leverage PurgeTSS modifiers instead of writing conditional logic in controllers.

```xml
<View class="mt-5 ios:mt-10 tablet:mt-20" />
```

## applyProperties() Pattern
Use `applyProperties()` to batch UI updates and minimize bridge crossings for properties not managed by classes.

```javascript
$.nameLabel.applyProperties({
  text: user.name,
  opacity: 1
})
```

## ListView Templates
Always use templates for performance. Never create views dynamically inside list rows.

```javascript
function renderUsers(users) {
  const data = users.map(user => ({
    name: { text: user.name },
    template: 'userTemplate'
  }))
  $.section.items = data
}
```

## Memory Cleanup
Always remove listeners to avoid memory leaks. Implement a `cleanup` function.

```javascript
function cleanup() {
  $.destroy()
  // Remove Ti.App listeners here
}
```

## i18n and Accessibility (a11y)
Use `L()` for all text and always include `accessibilityLabel` for interactive elements.

```xml
<Label text="L('welcome_message')" accessibilityLabel="Welcome Header" />
<ImageView class="fa-solid fa-user" accessibilityLabel="User Profile Picture" />
```

## Icon Fonts (PurgeTSS Workflow)
Integrate icons using classes generated by `purgetss build-fonts`. Classes are mapped to both `text` and `title` properties.

```xml
<Label class="fa-solid fa-envelope text-gray-400 mr-2" />
<Button class="fas fa-play" title="L('play')" />
```

## Grid System
Use PurgeTSS percentage-based grid for alignments.

```xml
<View class="horizontal w-screen">
  <View class="w-8/12 bg-red-500" />
  <View class="w-4/12 bg-blue-500" />
</View>
```

For true grid layouts, use the Grid component:
```xml
<View class="grid-cols-3 gap-2">
  <View class="bg-red-500" />
  <View class="bg-blue-500" />
  <View class="bg-green-500" />
</View>
```

## Animation Component
PurgeTSS includes an Animation component (`purgetss.ui`) for 2D Matrix transformations.

```xml
<Animation id="myAnim" module="purgetss.ui" class="open:opacity-100 close:opacity-0 duration-500" />
```
